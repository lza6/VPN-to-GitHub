# VPN-to-GitHub

自动把CM软件产生的节点配置上传到GitHub的桌面应用程序。

## 📖 项目简介

这是一个基于 PyQt6 开发的 GitHub 自动上传工具，可以智能地将本地配置文件同步到指定的 GitHub 仓库。支持定时上传、文件监控、GitHub CLI 认证等功能，非常适合需要定期备份配置文件的用户。

## ✨ 主要功能

- 🔄 **自动上传**：支持定时自动上传配置文件到 GitHub
- 📁 **智能监控**：自动检测文件变化，只上传有修改的文件
- 🔐 **安全认证**：使用 GitHub CLI 进行安全认证
- 📦 **仓库管理**：支持选择不同的 GitHub 仓库和分支
- ⏰ **灵活调度**：可自定义上传间隔（1-168小时）
- 🎨 **现代界面**：精美的 PyQt6 图形界面，操作简单直观
- 🔔 **系统托盘**：支持最小化到系统托盘，后台运行

## 🚀 快速开始

### 环境要求

- Windows 10/11
- Python 3.10+
- Git
- GitHub CLI (gh)

### 安装步骤

#### 1. 安装 Python

下载并安装 Python 3.10 或更高版本：
- 访问 https://www.python.org/downloads/
- 下载 Windows 版本
- 安装时勾选 "Add Python to PATH"

# 小白直接启动仓库的stear.bat脚本即可自动创建虚拟环境自动安装依赖

## 📖 使用教程（小白必读）

### 第一步：登录 GitHub

1. 启动程序后，点击"🔐 GitHub 账号"区域的"登录 GitHub"按钮
2. 系统会自动打开浏览器，跳转到 GitHub 授权页面
3. 登录你的 GitHub 账号并点击"Authorize"授权
4. 授权成功后，程序会自动返回并显示"已登录"状态

### 第二步：选择文件夹

1. 点击"📁 文件夹设置"区域的"浏览"按钮
2. 选择包含配置文件的文件夹（例如：CM软件的输出目录）
3. 程序会自动识别该文件夹中的配置文件

支持的文件类型：
- `ACL4SSR_Online_FullyamI`
- `all.yaml`
- `base64.txt`
- `bdg.yaml`
- `mihomo.yaml`

### 第三步：设置 GitHub 仓库

1. 点击"📦 GitHub 仓库设置"区域的"选择仓库"下拉框
2. 从列表中选择你要上传的仓库
3. 如果没有看到目标仓库，点击刷新按钮重新加载
4. 选择目标分支（通常是 main 或 master）
5. 点击"初始化"按钮，程序会自动配置仓库

### 第四步：设置定时上传

1. 在"⏰ 定时上传设置"区域，设置上传间隔
2. 建议设置为 6-12 小时，避免频繁上传
3. 可勾选"最小化到系统托盘"，让程序在后台运行

### 第五步：开始任务

1. 在"🚀 操作控制"区域，设置首次上传时间
2. 点击"⚡ 设置为当前+10秒"可以快速设置
3. 点击"📅 开始任务"按钮启动自动上传
4. 程序会开始按设定的时间间隔自动上传文件

### 第六步：查看运行状态

- 在"运行日志"区域可以查看详细的操作日志
- 状态栏会显示：
  - 当前状态（运行中/已停止）
  - 下次上传时间
  - 上次上传时间
  - 累计上传次数
  - 成功/失败次数

### 手动上传

如果需要立即上传，可以：
1. 右键点击系统托盘图标
2. 选择"立即上传"

### 停止任务

点击"⏹ 停止任务"按钮即可停止自动上传。

## 🔧 配置说明

程序配置保存在 `app_config.json` 文件中，包含以下信息：

```json
{
  "repo_full_name": "用户名/仓库名",
  "repo_url": "仓库地址",
  "branch": "分支名",
  "target_folder": "本地文件夹路径",
  "upload_interval_hours": 上传间隔（小时）,
  "files_to_upload": ["支持的文件列表"],
  "file_hashes": {"文件名": "文件哈希值"},
  "git_username": "GitHub用户名",
  "git_email": "GitHub邮箱"
}
```

## 📂 项目结构

```
自动上传到GitHub/
├── main.py                 # 程序入口
├── main_window.py          # 主窗口界面
├── config_manager.py       # 配置管理
├── git_manager.py          # Git操作管理
├── github_auth.py          # GitHub认证
├── file_watcher.py         # 文件监控
├── scheduler.py            # 定时任务调度
├── credential_manager.py   # 凭证管理
├── requirements.txt        # 依赖列表
├── start.bat              # 启动脚本
├── app_config.json        # 配置文件（自动生成）
└── README.md              # 说明文档
```

## ❓ 常见问题

### Q1: 登录失败怎么办？

A: 确保已安装 GitHub CLI 并正确配置。可以尝试：
1. 打开命令行，运行 `gh auth login` 手动登录
2. 检查网络连接
3. 清除浏览器缓存后重试

### Q2: 上传失败怎么办？

A: 检查以下几点：
1. 确认 GitHub 仓库存在且有写入权限
2. 检查本地文件夹路径是否正确
3. 查看"运行日志"了解具体错误信息
4. 确保网络连接正常

### Q3: 文件上传不完整？

A: 确认：
1. 文件名是否在支持的文件列表中
2. 文件是否有修改（程序只上传有变化的文件）
3. 检查文件大小是否超出限制

### Q4: 如何修改上传间隔？

A: 在"⏰ 定时上传设置"区域修改"上传间隔"数值，然后点击"💾 保存配置"按钮。

### Q5: 程序关闭后还会继续上传吗？

A: 不会。如果需要持续运行，请：
1. 勾选"最小化到系统托盘"
2. 点击窗口最小化按钮，程序会在托盘继续运行

### Q6: 如何更换仓库？

A:
1. 先停止当前任务
2. 在仓库下拉框中选择新仓库
3. 点击"初始化"按钮
4. 重新开始任务

## 🔒 安全说明

- GitHub 认证使用 GitHub CLI 的官方认证方式，安全可靠
- 凭证信息保存在系统安全存储中（Windows凭据管理器）
- 不会记录或上传任何密码信息
- 建议使用个人访问令牌（Personal Access Token）而不是密码

## 📝 注意事项

1. **首次使用**：首次使用需要登录 GitHub 并初始化仓库
2. **文件权限**：确保本地文件夹和 GitHub 仓库都有写入权限
3. **网络要求**：需要稳定的网络连接，支持访问 GitHub
4. **时间设置**：建议设置合理的上传间隔，避免频繁操作
5. **日志管理**：定期清理日志文件，避免占用过多空间

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

本项目采用 MIT 许可证。

## 📮 联系方式

如有问题或建议，欢迎提交 Issue 或联系作者。

---

**祝使用愉快！** 🎉
